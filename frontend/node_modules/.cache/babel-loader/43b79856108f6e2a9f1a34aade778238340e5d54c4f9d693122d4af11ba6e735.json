{"ast":null,"code":"var _jsxFileName = \"/Users/kapilshinde/Desktop/Medisync/frontend/src/pages/patient/PaymentPage.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport API from \"../../api/api\";\nimport Navbar from \"../../components/Navbar\";\nimport { jwtDecode } from \"jwt-decode\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction PaymentPage() {\n  _s();\n  const [pending, setPending] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [patientId, setPatientId] = useState(null);\n\n  // üîê Get patient id from JWT\n  useEffect(() => {\n    const token = sessionStorage.getItem(\"token\");\n    if (token) {\n      const decoded = jwtDecode(token);\n      setPatientId(decoded.id);\n    }\n  }, []);\n\n  // Load pending bills after patientId available\n  useEffect(() => {\n    if (patientId) {\n      loadPending();\n    }\n  }, [patientId]);\n\n  // üì• Load all pending bills\n  const loadPending = async () => {\n    try {\n      const {\n        data\n      } = await API.get(`/bills/pending/${patientId}`);\n      setPending(data);\n    } catch (err) {\n      setPending({\n        hasPending: false\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // üí≥ Pay specific bill\n  const payNow = async bill => {\n    try {\n      const {\n        data\n      } = await API.post(\"http://localhost:5005/payment/create-order\", {\n        amount: bill.amount,\n        patientId: patientId,\n        appointmentId: bill.appointmentId\n      });\n      const options = {\n        key: \"RAZORPAY_KEY_ID\",\n        // ‚Üê replace with real key later\n\n        order_id: data.id,\n        handler: async function (response) {\n          await API.post(\"http://localhost:5005/payment/verify\", response);\n          alert(\"Payment Successful\");\n\n          // refresh list\n          loadPending();\n        },\n        theme: {\n          color: \"#0d6efd\"\n        }\n      };\n      const rzp = new window.Razorpay(options);\n      rzp.open();\n    } catch (err) {\n      var _err$response, _err$response$data;\n      alert(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || \"Payment failed\");\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container mt-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Payment Gateway\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this), loading && /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Loading...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 21\n      }, this), !loading && !(pending !== null && pending !== void 0 && pending.hasPending) && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"alert alert-success\",\n        children: \"No payment pending\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 11\n      }, this), !loading && (pending === null || pending === void 0 ? void 0 : pending.hasPending) && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card p-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n          className: \"mb-3\",\n          children: \"Pending Bills\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 13\n        }, this), pending.bills.map(b => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"border rounded p-3 mb-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Bill ID:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 19\n            }, this), \" \", b.billId]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Appointment:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 121,\n              columnNumber: 19\n            }, this), \" \", b.appointmentId]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Amount:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 126,\n              columnNumber: 19\n            }, this), \" \\u20B9\", b.amount]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-primary\",\n            onClick: () => payNow(b),\n            children: \"Pay Now\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 17\n          }, this)]\n        }, b.billId, true, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 15\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s(PaymentPage, \"pBJoSqjJ11MOnEdEKdbKnfsnHwc=\");\n_c = PaymentPage;\nexport default PaymentPage;\nvar _c;\n$RefreshReg$(_c, \"PaymentPage\");","map":{"version":3,"names":["useEffect","useState","API","Navbar","jwtDecode","jsxDEV","_jsxDEV","Fragment","_Fragment","PaymentPage","_s","pending","setPending","loading","setLoading","patientId","setPatientId","token","sessionStorage","getItem","decoded","id","loadPending","data","get","err","hasPending","payNow","bill","post","amount","appointmentId","options","key","order_id","handler","response","alert","theme","color","rzp","window","Razorpay","open","_err$response","_err$response$data","message","children","fileName","_jsxFileName","lineNumber","columnNumber","className","bills","map","b","billId","onClick","_c","$RefreshReg$"],"sources":["/Users/kapilshinde/Desktop/Medisync/frontend/src/pages/patient/PaymentPage.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport API from \"../../api/api\";\nimport Navbar from \"../../components/Navbar\";\nimport { jwtDecode } from \"jwt-decode\";\n\nfunction PaymentPage() {\n\n  const [pending, setPending] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [patientId, setPatientId] = useState(null);\n\n  // üîê Get patient id from JWT\n  useEffect(() => {\n    const token = sessionStorage.getItem(\"token\");\n\n    if (token) {\n      const decoded = jwtDecode(token);\n      setPatientId(decoded.id);\n    }\n  }, []);\n\n  // Load pending bills after patientId available\n  useEffect(() => {\n    if (patientId) {\n      loadPending();\n    }\n  }, [patientId]);\n\n  // üì• Load all pending bills\n  const loadPending = async () => {\n    try {\n      const { data } = await API.get(\n        `/bills/pending/${patientId}`\n      );\n\n      setPending(data);\n\n    } catch (err) {\n      setPending({ hasPending: false });\n\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // üí≥ Pay specific bill\n  const payNow = async (bill) => {\n    try {\n\n      const { data } = await API.post(\n        \"http://localhost:5005/payment/create-order\",\n        {\n          amount: bill.amount,\n          patientId: patientId,\n          appointmentId: bill.appointmentId,\n        }\n      );\n\n      const options = {\n        key: \"RAZORPAY_KEY_ID\",   // ‚Üê replace with real key later\n\n        order_id: data.id,\n\n        handler: async function (response) {\n\n          await API.post(\n            \"http://localhost:5005/payment/verify\",\n            response\n          );\n\n          alert(\"Payment Successful\");\n\n          // refresh list\n          loadPending();\n        },\n\n        theme: { color: \"#0d6efd\" },\n      };\n\n      const rzp = new window.Razorpay(options);\n      rzp.open();\n\n    } catch (err) {\n      alert(err.response?.data?.message || \"Payment failed\");\n    }\n  };\n\n  return (\n    <>\n      <Navbar />\n\n      <div className=\"container mt-4\">\n\n        <h3>Payment Gateway</h3>\n\n        {loading && <p>Loading...</p>}\n\n        {/* NO PENDING */}\n        {!loading && !pending?.hasPending && (\n          <div className=\"alert alert-success\">\n            No payment pending\n          </div>\n        )}\n\n        {/* MULTIPLE PENDING BILLS */}\n        {!loading && pending?.hasPending && (\n          <div className=\"card p-3\">\n\n            <h5 className=\"mb-3\">Pending Bills</h5>\n\n            {pending.bills.map((b) => (\n              <div\n                className=\"border rounded p-3 mb-2\"\n                key={b.billId}\n              >\n                <p>\n                  <strong>Bill ID:</strong> {b.billId}\n                </p>\n\n                <p>\n                  <strong>Appointment:</strong>{\" \"}\n                  {b.appointmentId}\n                </p>\n\n                <p>\n                  <strong>Amount:</strong> ‚Çπ{b.amount}\n                </p>\n\n                <button\n                  className=\"btn btn-primary\"\n                  onClick={() => payNow(b)}\n                >\n                  Pay Now\n                </button>\n              </div>\n            ))}\n          </div>\n        )}\n\n      </div>\n    </>\n  );\n}\n\nexport default PaymentPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}